{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Veterinaria Chucky PB | Dashboard</title>
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- FontAwesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f8f9fc;
            overflow-x: hidden;
        }
        
        /* Dashboard Card Styles */
        .border-left-primary { border-left: .25rem solid #4e73df!important; }
        .border-left-success { border-left: .25rem solid #1cc88a!important; }
        .border-left-info { border-left: .25rem solid #36b9cc!important; }
        .border-left-warning { border-left: .25rem solid #f6c23e!important; }
        
        .text-gray-300 { color: #dddfeb!important; }
        .text-gray-800 { color: #5a5c69!important; }
        
        /* Hero Styles (Unauthenticated) */
        .hero-section {
            background: linear-gradient(rgba(44, 62, 80, 0.8), rgba(44, 62, 80, 0.7)), 
                        url('https://images.unsplash.com/photo-1553688738-a278b9f063e0?auto=format&fit=crop&w=1920&q=80');
            background-size: cover;
            background-position: center;
            height: 100vh;
            display: flex;
            align-items: center;
            color: white;
        }
        .navbar-brand { font-weight: 700; font-size: 1.5rem; }
    </style>
</head>
<body>

{% if user.is_authenticated %}
    <!-- USUARIO LOGUEADO: REDIRECT AL PANEL INTERNO -->
    <!-- En realidad, si usa el index como dashboard, mostramos el layout del panel -->
    
    <!-- Vamos a reutilizar el wrapper de base.html pero renderizando contenido específico aquí -->
    <!-- Nota: Como index.html no extiende base.html en mi diseño anterior para ser Landing Page,
         ahora que es Dashboard, debería extender base.html SI está logueado.
         Django templates no permite 'extends' condicional fácilmente.
         
         SOLUCIÓN: Usaré un script de redirección JS simple o un botón grande, 
         PERO mejor aún: haré que esta vista sea la Landing y el Dashboard sea 'base.html'.
         
         Sin embargo, para cumplir "Dashboard de Bienvenida (Index)", haré una estructura híbrida simple.
    -->
    
    <!-- Navbar Simple -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow mb-4 static-top">
        <div class="container">
            <a class="navbar-brand text-primary" href="#"><i class="fas fa-paw me-2"></i>Chucky PB Panel</a>
            <div class="ms-auto">
                <span class="me-3 text-gray-600">Hola, <b>{{ user.username }}</b></span>
                <form action="{% url 'logout' %}" method="post" class="d-inline">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-outline-danger btn-sm rounded-pill">Cerrar Sesión</button>
                </form>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="d-sm-flex align-items-center justify-content-between mb-4">
            <h1 class="h3 mb-0 text-gray-800">Resumen General</h1>
            <a href="{% url 'producto_create' %}" class="btn btn-sm btn-primary shadow-sm"><i class="fas fa-plus fa-sm text-white-50 me-1"></i> Crear Producto</a>
        </div>

        <div class="row">
            <!-- Earnings (Monthly) Card Example -->
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-primary shadow h-100 py-2">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                    Mis Productos</div>
                                <div class="h5 mb-0 font-weight-bold text-gray-800">{{ total_productos }}</div>
                            </div>
                            <div class="col-auto">
                                <i class="fas fa-box fa-2x text-gray-300"></i>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer bg-white border-0">
                        <a href="{% url 'producto_list' %}" class="text-primary small stretched-link">Ver detalles <i class="fas fa-arrow-right ms-1"></i></a>
                    </div>
                </div>
            </div>

            {% if user.is_superuser %}
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-success shadow h-100 py-2">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                                    Categorías Totales</div>
                                <div class="h5 mb-0 font-weight-bold text-gray-800">{{ total_categorias }}</div>
                            </div>
                            <div class="col-auto">
                                <i class="fas fa-tags fa-2x text-gray-300"></i>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer bg-white border-0">
                        <a href="{% url 'categoria_list' %}" class="text-success small stretched-link">Gestionar <i class="fas fa-arrow-right ms-1"></i></a>
                    </div>
                </div>
            </div>
            {% endif %}

            <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-info shadow h-100 py-2">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div class="text-xs font-weight-bold text-info text-uppercase mb-1">Mi Perfil</div>
                                <div class="h5 mb-0 font-weight-bold text-gray-800">Activo</div>
                            </div>
                            <div class="col-auto">
                                <i class="fas fa-user-check fa-2x text-gray-300"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="alert alert-info mt-4 shadow-sm border-0" role="alert">
            <h4 class="alert-heading"><i class="fas fa-info-circle me-2"></i>¡Bienvenido al Sistema!</h4>
            <p>Utiliza el menú superior o las tarjetas para navegar. Recuerda que tienes permisos limitados según tu rol.</p>
        </div>
    </div>

{% else %}
    <!-- USUARIO NO LOGUEADO: LANDING PAGE -->
    <nav class="navbar navbar-expand-lg fixed-top navbar-dark bg-transparent">
        <div class="container">
            <a class="navbar-brand" href="#"><i class="fas fa-paw me-2 text-warning"></i>Chucky PB</a>
            <div class="ms-auto">
                <a href="{% url 'login' %}" class="btn btn-warning rounded-pill px-4 fw-bold text-dark">
                    <i class="fas fa-sign-in-alt me-2"></i>Entrar
                </a>
            </div>
        </div>
    </nav>

    <section class="hero-section">
        <div class="container text-center">
            <h1 class="display-2 fw-bold mb-4">Veterinaria Chucky PB</h1>
            <p class="lead mb-5 mx-auto" style="max-width: 700px;">Sistema integral para la gestión de inventario clínico. Controla productos, precios y categorías con la máxima eficiencia.</p>
            <div class="d-flex justify-content-center gap-3">
                <a href="{% url 'login' %}" class="btn btn-primary btn-lg px-5 rounded-pill shadow-lg">Iniciar Sesión</a>
            </div>
        </div>
    </section>
{% endif %}

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
